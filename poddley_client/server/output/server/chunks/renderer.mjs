import{createRenderer as e}from"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/vue-bundle-renderer/dist/runtime.mjs";import{eventHandler as t,setResponseStatus as o,getQuery as s,createError as n}from"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/h3/dist/index.mjs";import{stringify as r,uneval as d}from"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/devalue/index.js";import{renderToString as a}from"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/vue/server-renderer/index.mjs";import{u as i,a as l,g as p}from"./nitro/nitro-prerenderer.mjs";import{joinURL as u}from"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/ufo/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/node-fetch-native/dist/polyfill.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/ofetch/dist/node.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/destr/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/unenv/runtime/fetch/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/hookable/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/scule/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/klona/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/defu/dist/defu.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/ohash/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/unstorage/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/unstorage/drivers/fs.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/radix3/dist/index.mjs";import"node:fs";import"node:url";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/pathe/dist/index.mjs";import"file://C:/Users/lukav/Desktop/poddley/poddley_client/node_modules/ipx/dist/index.mjs";function buildAssetsURL(...e){return u(publicAssetsURL(),l().app.buildAssetsDir,...e)}function publicAssetsURL(...e){const t=l().app.cdnURL||l().app.baseURL;return e.length?u(t,...e):t}const c="__nuxt",m="div";globalThis.__buildAssetsURL=buildAssetsURL,globalThis.__publicAssetsURL=publicAssetsURL;const getClientManifest=()=>import("./app/client.manifest.mjs").then((e=>e.default||e)).then((e=>"function"==typeof e?e():e)),getStaticRenderedHead=()=>import("./rollup/_virtual_head-static.mjs").then((e=>e.default||e)),y=lazyCachedFunction((()=>import("./app/styles.mjs").then((e=>e.default||e)))),f=lazyCachedFunction((async()=>{const t=await getClientManifest();if(!t)throw new Error("client.manifest is not available");const o=await import("./app/server.mjs").then((e=>e.default||e));if(!o)throw new Error("Server bundle is not available");return e(o,{manifest:t,renderToString:async function(e,t){const o=await a(e,t);return`<${m} id="${c}">${o}</${m}>`},buildAssetsURL:buildAssetsURL})})),_=lazyCachedFunction((async()=>{const t=await getClientManifest(),o=await import("./rollup/_virtual_spa-template.mjs").then((e=>e.template)).catch((()=>"")),s=e((()=>()=>{}),{manifest:t,renderToString:()=>`<${m} id="${c}">${o}</${m}>`,buildAssetsURL:buildAssetsURL}),n=await s.renderToString({});return{rendererContext:s.rendererContext,renderToString:e=>{const t=l();return e.modules=e.modules||new Set,e.payload={_errors:{},serverRendered:!1,data:{},state:{}},e.config={public:t.public,app:t.app},e.renderMeta=e.renderMeta??getStaticRenderedHead,Promise.resolve(n)}}})),h=null,A=/\/_payload(\.[a-zA-Z0-9]+)?.json(\?.*)?$/,k=new Set(["/index.html","/200.html","/404.html"]),C=(v=async e=>{const t=i(),o=e.node.req.url?.startsWith("/__nuxt_error")?s(e):null;if(o&&o.statusCode&&(o.statusCode=parseInt(o.statusCode)),o&&"readOnly"!==e.node.req.socket.readyState)throw n({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const d=void 0;let a=o?.url||e.node.req.url;const u=A.test(a)&&!0;if(u&&(a=a.substring(0,a.lastIndexOf("/"))||"/",e.node.req.url=a,h.has(a)))return h.get(a);const c=p(e),m={url:a,event:e,runtimeConfig:l(),noSSR:e.context.nuxt?.noSSR||!1===c.ssr||k.has(a),error:!!o,nuxt:void 0,payload:o?{error:o}:{},_payloadReducers:{},islandContext:d};m.payload.prerenderedAt=Date.now();const C=m.noSSR?await _():await f(),v=await C.renderToString(m).catch((async e=>{if(m._renderResponse&&"skipping render"===e.message)return{};const t=!o&&m.payload?.error||e;throw await(m.nuxt?.hooks.callHook("app:error",t)),t}));if(await(m.nuxt?.hooks.callHook("app:rendered",{ssrContext:m,renderResult:v})),m._renderResponse)return m._renderResponse;if(m.payload?.error&&!o)throw m.payload.error;if(u){const e=function(e){return{body:r(splitPayload(e).payload,e._payloadReducers),statusCode:e.event.node.res.statusCode,statusMessage:e.event.node.res.statusMessage,headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(m);return h.set(a,e),e}const b=await(m.renderMeta?.())??{};{const e=m.modules??m._registeredComponents;if(e)for(const t of await getClientManifest().then((e=>Object.values(e).filter((e=>e._globalCSS)).map((e=>e.src)))))e.add(t)}const x=await async function(e){const t=await y(),o=new Set;for(const s of e)if(s in t)for(const e of await t[s]())o.add(`<style>${e}</style>`);return Array.from(o).join("")}(m.modules??m._registeredComponents??[]),j=c.experimentalNoScripts,g={island:Boolean(d),htmlAttrs:normalizeChunks([b.htmlAttrs]),head:normalizeChunks([b.headTags,null,j?null:v.renderResourceHints(),v.renderStyles(),x,m.styles]),bodyAttrs:normalizeChunks([b.bodyAttrs]),bodyPrepend:normalizeChunks([b.bodyScriptsPrepend,m.teleports?.body]),body:[v.html],bodyAppend:normalizeChunks([j?void 0:renderPayloadJsonScript({id:"__NUXT_DATA__",ssrContext:m,data:m.payload}),c.experimentalNoScripts?void 0:v.renderScripts(),b.bodyScripts])};var w;return await t.hooks.callHook("render:html",g,{event:e}),{body:(w=g,`<!DOCTYPE html>\n<html ${joinAttrs(w.htmlAttrs)}>\n<head>${joinTags(w.head)}</head>\n<body ${joinAttrs(w.bodyAttrs)}>${joinTags(w.bodyPrepend)}${joinTags(w.body)}${joinTags(w.bodyAppend)}</body>\n</html>`),statusCode:e.node.res.statusCode,statusMessage:e.node.res.statusMessage,headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}}},t((async e=>{if(e.node.req.url.endsWith("/favicon.ico"))return void(e.handled||(e.node.res.setHeader("Content-Type","image/x-icon"),e.node.res.end("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")));const t=await v(e);if(!t)return void(e.handled||(e.node.res.statusCode=200===e.node.res.statusCode?500:e.node.res.statusCode,e.node.res.end("No response returned from render handler: "+e.node.req.url)));const s=i();if(await s.hooks.callHook("render:response",t,{event:e}),!e.node.res.headersSent&&t.headers){for(const o in t.headers)e.node.res.setHeader(o,t.headers[o]);o(e,t.statusCode,t.statusMessage)}return"string"==typeof t.body?t.body:JSON.stringify(t.body)})));var v;function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch((e=>{throw t=null,e}))),t)}function normalizeChunks(e){return e.filter(Boolean).map((e=>e.trim()))}function joinTags(e){return e.join("")}function joinAttrs(e){return e.join(" ")}function renderPayloadJsonScript(e){const t=['type="application/json"',`id="${e.id}"`,`data-ssr="${!e.ssrContext.noSSR}"`,e.src?`data-src="${e.src}"`:""].filter(Boolean),o=e.data?r(e.data,e.ssrContext._payloadReducers):"";return`<script ${t.join(" ")}>${o}<\/script><script>window.__NUXT__={};window.__NUXT__.config=${d(e.ssrContext.config)}<\/script>`}function splitPayload(e){const{data:t,prerenderedAt:o,...s}=e.payload;return{initial:{...s,prerenderedAt:o},payload:{data:t,prerenderedAt:o}}}export{C as default};
//# sourceMappingURL=renderer.mjs.map
